## 并发控制概述

系统中，可能同时运行着多个事务，而事务的运行需要时间 ，并且事务中的操作是在一
定的数据上进行的。当系统中同时有多个事务在运行时，特别是当这些事务是对同一段数据进行操作时，彼此之间就有可能产生相互干扰的情况。

### 不同的多事务执行方式

1. 串行执行

每个时刻只有一个事务运行，其他事务必须等到这个事务结束以后方能运行。

![[assets/Pasted image 20240310170831.png]]

问题：不能充分利用系统资源，发挥数据库共享资源的特点。

2. **交叉并行执行**

在单处理机系统中，事务的并行执行是这些并行事务的并行操作轮流交叉运行。

单处理机系统中的并行事务并没有真正地并行运行，但能够**减少处理机的空闲时间**，提高系统的效率。

![[assets/Pasted image 20240310170919.png]]

3. 同时并发方式

多处理机系统中，每个处理机可以运行一个事务。多个处理机可以同时运行多个事务，实
现多个事务真正的并行运行。

### 并发带来的问题

```ad-example
飞机订票系统中的一个活动序列：
1. 甲售票点(甲事务)读出某航班的机票余额A，设A=16;
2. 乙售票点(乙事务)读出同一航班的机票余额A，也为16;
3. 甲售票点卖出一张票，修改余额A←A-1，所以A为15，写回数据库。
4. 乙售票点也卖出一张票，修改余额A←A-1，所以A为15，写会数据库。

结果：明明卖出两张机票，数据库中机票余额只减少1
原因：第4步中乙事务修改A并写回后覆盖了甲事务的修改。
```

问题：
- 多个事务同时存取同一数据的情况。
- 可能会存取和存储不正确的数据。
- 破坏事务一致性和数据库的一致性。

并发控制是衡量 DBMS 性能的重要标志之一。

并发控制机制的任务
- 对并发操作进行**正确调度**
- 保证事务的**隔离性**
- 保证数据库的**一致性**

### 数据不一致情况

- 丢失修改(LostUpdate)
- 读“脏”数据(DirtyRead)
- 不可重复读(Non-repeatableRead)
- 产生“幽灵”数据

**丢失修改(LostUpdate)**



**读“脏”数据(DirtyRead)**



**不可重复读(Non-repeatableRead)**



**产生“幽灵”数据**



## 并发控制措施


## 封锁协议


## 死锁


## 并发调度的可串行性


## 两段锁协议