## 【18】组成原理

如何理解存储器的地址线和数据线？
缓冲的定义，为什么引入？
简要谈谈高速缓存的原理？
IO 接口是什么？
中断产生的原因？
Cache 的映像方式？

> 冯·诺依曼计算机的特点是什么？

1. 冯·诺依曼计算机主要由**五个部件**组成，分别是：运算器、控制器、存储器、输入设备和输出设备；
2. 冯诺依曼体系结构的指令和数据均采用**二进制**码表示，以同等地位存放于存储器中，均可按地址寻访；
3. 指令由**操作码和地址**码组成，操作码用来表示操作的性质，地址码用来表示操作数所在存储器中的位置；
4. 指令在存储器中按**顺序存放**，通常指令是按顺序执行的，特定条件下，可以根据运算结果或者设定的条件改变执行顺序；
5. 机器以**运算器**为中心，输入输出设备和存储器的数据传送通过运算器完成。

> CPU 组成部分及其功能？

1. **控制单元（Control Unit，CU）**：
    - 控制单元负责从内存中读取解释并执行指令序列，指导数据在各个部件之间的传输和处理。
2. **算术逻辑单元（Arithmetic Logic Unit，ALU）**：
    - 算术逻辑单元是CPU的核心部件，根据控制单元发出的指令对数据进行处理，负责执行算术运算（如加法、减法、乘法、除法）和逻辑运算（如与、或、非、异或）并生成运算结果。
3. **寄存器（Registers）**：
    - 寄存器是CPU内部的高速存储器件，用于临时存储指令、数据和中间结果。
    - CPU中包括多种寄存器，如程序计数器（PC）、指令寄存器（IR）、累加器（Accumulator）、数据寄存器等。
4. **时钟（Clock）**：
    - 时钟是CPU的一个重要组成部分，用于同步各个部件的工作。
    - 时钟发出的脉冲信号控制CPU内部各个部件的操作，确保它们按照统一的时间间隔进行工作。
5. **数据总线和地址总线**：
    - 数据总线用于在CPU和其他设备之间传输数据。
    - 地址总线用于指示内存中的地址，从而读取或写入数据。
6. **缓存（Cache）**：
    - 缓存是CPU内部的一种高速存储器，用于暂时存储频繁访问的数据和指令，以提高数据访问速度。
    - 缓存分为指令缓存（Instruction Cache）和数据缓存（Data Cache），分别用于存储指令和数据。

> 怎样用最有效率的方法计算 2 乘以 8？

计算 2 乘 8 最有效的方法是利用二进制位移运算。在二进制中，将一个数左移一位相当于乘以 2，因此将 2 左移 3 位相当于 2 乘以 8。

2 的二进制表示为 10，将其左移 3 位，得到的结果为 10000（二进制）。将二进制数转换为十进制，即可得到最终的结果。

> CPU 有哪些寄存器？

在CPU中至少要有六类寄存器：指令寄存器（IR）、程序计数器（PC）、存储器地址寄存器（MAR）、存储器数据寄存器（MDR）、累加寄存器（AC）、程序状态字寄存器（PSW）。

**存储器数据寄存器**：用来作为从主存读入或者向主存写入的指令或者数据，弥补了CPU和主存以及外围设备速度上的差异。
**存储器地址寄存器**：用来保存CPU当前所访问的主存单元的地址。
**指令寄存器**：用来保存当前正在执行的一条指令。
**程序计数器**：用来指出下一条指令在主存储器中的地址。
**累加寄存器**：是一个通用寄存器。为ALU暂时保存一个操作数或运算结果。
**程序状态字寄存器（标志寄存器）**：存储着执行指令后的状态标志，用于控制程序的流程和执行条件判断。

> 存储器的带宽？

**是什么**：存储器的带宽指的是在单位时间内从存储器读取或写入数据的速率。

**影响因素**：
1. **存储器类型：** 不同类型的存储器（例如DDR4/5 RAM、SSD等）具有不同的带宽。    
2. **总线宽度：** 存储器的总线宽度决定了每个时钟周期内可以传输的数据位数。
3. **时钟速率：** 存储器的时钟速率表示每秒钟的时钟周期数，它直接影响存储器每秒钟可以执行的操作次数。
4. **通道数量：** 一些存储器具有多个通道，允许同时进行多个数据传输操作，从而提高了带宽。
5. **数据传输协议：** 存储器使用的数据传输协议（例如DDR、PCIe）也会影响其带宽。一些新的数据传输协议具有更高的带宽。

> 计算机组成原理的 DRAM 为什么刷新？

DRAM内部的存储单元是由电容器构成的，电容器可以存储电荷来表示数据的1或0。然而，由于电容器本身会逐渐失去电荷，这意味着存储的数据会逐渐消失。这种现象被称为电容器的漏电现象。

为了保持数据的稳定性，防止数据丢失，DRAM需要定期进行刷新操作。

> 说出几种你了解的存储器和特点？

首先按照存储方式可以分为内存和外存，内存的类型有RAM，ROM等类型，外存有SSD，HDD，光盘等存储器。然后我会介绍以上几种存储器的特点。

1. **RAM**。随机存储器的任何一个存储单元都可以随机存取，而且存取时间与存储单元的物理位置无关。其优点是读写方便、使用灵活，主要用作主存或cache。RAM又分为静态RAM和动态RAM。
2. **ROM**。只读存储器的内容只能随机读出而不能写入。信息旦写入存储器就固定不变，即使断电，内容也不会丢失。因此，通常用它存放固定不变的程序比如BIOS和固件等。写入速度比读出速度慢很多。
3. **HDD**。机械硬盘，使用旋转的磁盘（盘片）和移动的磁头来读取和写入数据。数据存储在盘片的表面上。
4. **SSD**。固态硬盘，基于闪存技术，通常比机械硬盘读写速度快。

> CPU 响应中断的条件是什么？

应中断的条件通常包括以下几点：

1. **中断信号到达**：中断信号由外部设备发送给CPU，表示需要CPU进行某种处理。这个信号可以是硬件中断（例如I/O设备完成数据传输、定时器计时结束等）或软件中断（例如系统调用、异常等）。
2. **中断使能**：CPU出于开中断状态。
3. **中断优先级**：如果多个中断同时发生，CPU会根据中断的优先级来确定响应的顺序。通常，具有更高优先级的中断会被优先处理。
4. **当前指令执行完成**：如果CPU正在执行指令，需要等待当前指令执行完成后才能响应中断。

> **CPU 与外设交换信息的方式（3种方式）？**

1. **程序查询方式**

原理：信息交换的控制完全由CPU执行程序实现，程序查询方式接口中设置一个数据端口和一个状态端口。主机进行IO操作时，先发出询问信号，读取设备的状态并根据设备状态决定下一步操作究竞是进行数据传送还是等待。

在这种控制方式下，CPU一旦启动IO，就必须停止现行程序的运行，并在现行程序中插入一段程序。程序查询方式的主要特点是CPU有“踏步”等待现象，CPU与I/O串行工作，在一段时间内只能和一台外设交换信息，效率大大降低。

2. **程序中断方式**

原理：CPU在程序中安排好在某个时机启动某台外设，然后CPU继续执行当前的程序，不需要像查询方式那样一直等待外设准备就绪。一旦外设完成数据传送的准备工作，就主动向CPU发出中断请求，请求CPU为自已服务。在可以响应中断的条件下，CPU暂时中止正在执行的程序，转去执行中断服务程序为外设服务，在中断服务程序中完成一次主机与外设之间的数据传送，传送完成后，CPU返回原来的程序。

3. **DMA方式**

直接存储器存取方式

DMA方式是一种完全由硬件进行成组信息传送的控制方式，它具有程序中断方式的优点，即在数据准备阶段，CPU与外设并行工作。DMA方式在外设与内存之间开辟一条“直接数据通道”，信息传送不再经过CPU，降低了CPU在传送数据时的开销。由于数据传送不经过CPU，也就不需要保护、恢复CPU现场等烦琐操作。

> DMA 接口的组成部分？

- **主存地址计数器**：存放要交换数据的主存地址。
- **传送长度计数器**：记录传送数据的长度，计数溢出时，数据即传送完毕，自动发中断请求信号。
- **数据缓冲寄存器**：暂存每次传送的数据。DMA请求触发器：每当VO设备准备好数据后，给出一个控制信号，使DMA请求触发器置位。
- **“控制/状态”逻辑**：由控制和时序电路及状态标志组成，用于指定传送方向，修改传送参数，并对DMA请求信号、CPU响应信号进行协调和同步。
- **中断机构**：当一个数据块传送完毕后触发中断机构，向CPU提出中断请求。
