### DHCP协议

**是什么**：动态主机配置协议（Dynamic Host Configuration Protocol）常用于给主机动态地分配IP地址，这种机制允许一台计算机加入新的网络和获取IP地址而不用手工参与。DHCP是==基于UDP的应用层协议==。

**工作原理**：基于客户/服务器模式。需要IP地址的主机在启动时就向DHCP服务器广播发送发现报文，这时该主机就成为DHCP客户。本地网络上所有主机都能收到此广播报文，但只有DHCP服务器才回答此广播报文。DHCP服务器先在其数据库中查找该计算机的配置信息。若找到，则返回找到的信息。若找不到，则从服务器的IP地址池中取一个地址分配给该计算机。

**工作过程**：
1. DHCP客户机广播“**DHCP发现**”消息，试图找到网络中的DHCP服务器，以便从DHCP服务器获得一个IP地址。源地址为0.0.0.0，目的地址为255.255.255.255。
2. DHCP服务器收到“DHCP发现”消息后，广播“**DHCP提供**”消息，其中包括提供给DHCP客户机的IP地址。源地址为DHCP服务器地址，目的地址为255.255.255.255。
3. DHCP客户机收到“DHCP提供”消息，如果接受该IP地址，那么就广播“**DHCP请求**”消息向DHCP服务器请求提供IP地址。源地址为0.0.0.0，目的地址为255.255.255.255。
4. DHCP服务器广播“**DHCP确认**”消息，将IP地址分配给DHCP客户机。源地址为DHCP服务器地址，目的地址为255.255.255.255。

*扩展：为什么需要广播交互*：DHCP的客户端和服务器端需要通过广播方式来进行交互，原因是在DHCP执行初期，客户端不知道服务器端的IP地址，而在执行中间，客户端并未被分配IP地址，从而导致两者之间的通信必须采用广播的方式。

*扩展：为什么使用UDP而不是TCP*：采用UDP而不采用TCP的原因也很明显：TCP需要建立连接，如果连对方的IP地址都不知道，那么更不可能通过双方的套接字建立连接。
