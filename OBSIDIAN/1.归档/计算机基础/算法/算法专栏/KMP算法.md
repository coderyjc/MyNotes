---
tags: 
- 基本算法/KMP算法
---


- 前缀：除了最后一个字符之外，字符串所有头部子串。
- 后缀：除了第一个字符之外，字符串的所有尾部子串。
- 部分匹配值：字符串的前缀和后缀的最长相等前后缀长度。

1. ‘a’的前缀是空集，最长相等前后缀长度为0
2. ‘ab’的前缀为a，后缀为b，{a} and {b} = 空集，最长相等前后缀长度为0。
3. ‘aba’，前缀｛a, ab｝后缀｛a, ba｝最长为2

| 字符串 | 前缀     | 后缀     | 交集 | 最长前后缀长度 |
| ------ | -------- | -------- | ---- | -------------- |
| a      | 空       | 空       | 空   | 0              |
| ab     | a        | b        | 空   | 0              |
| aba    | a, ab    | a,ba     | a    | 1              |
| abab   | a,ab,aba | bab,ab,b | ab   | 2              |

字符串abcac的部分匹配值：

| 下标     | 0   | 1   | 2   | 3   | 4   |
| -------- | --- | --- | --- | --- | --- |
| S        | a   | b   | c   | a   | c   |
| 部分匹配 | 0   | 0   | 0   | 1   | 0   |

### 匹配过程

**第一次匹配**

![[assets/Pasted image 20240306104633.png]]

下标为2时失配

`移动位数 = 已匹配的字符数 - 最后一个匹配字符对应的部分匹配值

所以子串后移2位（主串不回退）

**第二次匹配**

![[assets/Pasted image 20240306105234.png]]

bc失配，前面4个字符·abca'是匹配的，最后一个匹配字符a对应的部分匹配值为1，4-1=3，将子串向后移动3位

**第三次匹配**

![[assets/Pasted image 20240306105405.png]]

匹配成功

主串没有回退，所以KMP的时间复杂度可以为O(n+m)




当匹配过程中产生“ 失配 ”时，指针 i 不变，指针j退回到 `next[j]` 所指示的位置上重新进行比较，并且当指针 j 退至零时，指针 i 和指针j需同时增1,即若主串的第 l 个字符和模式的第 1 个字符不等，应该从珠串的第i+1个字符起重新进行匹配。

